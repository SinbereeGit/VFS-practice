<div align="center"><a name="readme-top"></a>

[![][mycat]][link-to-homepage]

[mycat]: assets/images/mycat.jpg
[link-to-homepage]: https://github.com/SinbereeGit

# Virtual File System

> Notes: This file is generated by *Copilot* based on this projects ðŸ˜„.  

**English** Â· [ç®€ä½“ä¸­æ–‡](./README_zh.md)

This project provides a virtual file system that supports *serial multi-user* and *deduplication storage*. It is uniquely determined by a (system root directory, specified user ID).

</div>

## âœ¨ Features

- **Serial Multi-User Support**: Allows multiple users to use the system serially.
- **Deduplication Storage**: Ensures that duplicate files are stored only once.
- **Virtual File System**: Provides a virtual file system with various operations.

## Usage

### Example

Using `with` statement:

```python
with VirtualFileSystem("root_dir", "user_id") as vfs:
    # Print the content of the current directory
    vfs.get_dir_content("")
    # Change to a specific directory
    vfs.chdir("dir_name")
    # Perform other operations...
```

Using `try` statement:

```python
try:
    vfs = VirtualFileSystem("root_dir", "user_id")
    # Print the content of the current directory
    vfs.get_dir_content("")
    # Change to a specific directory
    vfs.chdir("dir_name")
    # Perform other operations...
except Exception as e:
    # Handle exceptions
finally:
    vfs.store_change()
```

## Warnings

- All contents of the root directory must be generated by this module.
- Only one system instance can run at the same time for the same root directory (no concurrent support).
- Do not use the instance after calling `store_change` as its resources have been released.
- Internal path names currently have no strict naming restrictions.

## Notes

- Initialization details are in the `__init__` docstring.
- If not using `with`, use `try` and call `self.store_change` in `finally`.
- No parallel support.
- Supports Unix/Linux, Windows, and should support MacOS.
- Internal file paths use Unix format, external paths are OS-specific.
- File operations are non-overwriting.
- The directory structure is as follows:

  ```txt
  Root Directory
  â”œâ”€â”€ Reference Count File
  â”œâ”€â”€ Entity Files Directory
  â”‚   â”œâ”€â”€ Hash File 1
  â”‚   â”œâ”€â”€ Hash File 2
  â”‚   â””â”€â”€ ...
  â””â”€â”€ User Space Directory
      â”œâ”€â”€ User Directory 1
      â”‚   â””â”€â”€ User Directory Tree File
      â”œâ”€â”€ User Directory 2
      â”‚   â””â”€â”€ User Directory Tree File
      â””â”€â”€ ...
  ```

## Modules

### `virtual_file_system.py`

Provides the main `VirtualFileSystem` class with various file system operations.

### `_dir_tree_handler.py`

Handles directory trees corresponding to JSON files created by this module.

### `errors.py`

Defines various exceptions used in the file system.

### `_utils/count_manager.py`

Maintains counts for specified identifiers, supporting creation and increment/decrement operations.

### `_utils/file_hash.py`

Generates hash values for files using the SHA-256 algorithm.

### `tools/simple_ui.py`

Provides a simple command-line UI for using the file system.

## License

This project is licensed under the [GPL-3.0](LICENSE) License.
